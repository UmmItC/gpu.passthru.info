"use strict";(self.webpackChunkgpu_passthru_info=self.webpackChunkgpu_passthru_info||[]).push([[937],{8663:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"dual-gpu-passthru-desktop/Bootloader-enable-distro","title":"Edit Bootloader Configuration","description":"If your arch is ready to go, it\'s time to dive into bootloader configuration. To fine-tune your bootloader settings, let\u2019s customize them based on your CPU type:","source":"@site/docs/dual-gpu-passthru-desktop/Bootloader-enable-distro.mdx","sourceDirName":"dual-gpu-passthru-desktop","slug":"/dual-gpu-passthru-desktop/Bootloader-enable-distro","permalink":"/docs/dual-gpu-passthru-desktop/Bootloader-enable-distro","draft":false,"unlisted":false,"editUrl":"https://github.com/UmmItC/gpu-passthru/tree/master/docs/dual-gpu-passthru-desktop/Bootloader-enable-distro.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Enabling Virtualization in BIOS","permalink":"/docs/dual-gpu-passthru-desktop/BIOS"},"next":{"title":"Passthrough the GPU!","permalink":"/docs/dual-gpu-passthru-desktop/Passthrough-GPU"}}');var t=i(4848),r=i(8453);const s={sidebar_position:7},d="Edit Bootloader Configuration",l={},a=[{value:"Decoding the Parameters",id:"decoding-the-parameters",level:3},{value:"1.2 Configuring GRUB",id:"12-configuring-grub",level:2},{value:"GRUB Configuration Examples",id:"grub-configuration-examples",level:4},{value:"1.3 Configuring bootctl",id:"13-configuring-bootctl",level:2},{value:"What&#39;s Next",id:"whats-next",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"edit-bootloader-configuration",children:"Edit Bootloader Configuration"})}),"\n",(0,t.jsx)(n.p,{children:"If your arch is ready to go, it's time to dive into bootloader configuration. To fine-tune your bootloader settings, let\u2019s customize them based on your CPU type:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"AMD CPU"}),(0,t.jsx)(n.th,{children:"Intel CPU"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"amd_iommu=on"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"intel_iommu=on"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"video=efifb:off"})}),(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"iommu=pt"})})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:(0,t.jsx)(n.code,{children:"iommu=pt"})}),(0,t.jsx)(n.td,{})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"Each of these parameters plays a crucial role in enabling virtualization and improving your system's performance for virtual machines."}),"\n",(0,t.jsx)(n.h3,{id:"decoding-the-parameters",children:"Decoding the Parameters"}),"\n",(0,t.jsx)(n.p,{children:"Let\u2019s break down what each of these parameters does:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:"amd_iommu=on"})," (AMD) / ",(0,t.jsx)(n.code,{children:"intel_iommu=on"})," (Intel)"]}),": Activates IOMMU support for better hardware isolation and sharing, crucial for virtualization."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"video=efifb:off"})}),": Disables the EFI framebuffer driver, which can interfere with GPU passthrough."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"iommu=pt"})}),": Sets the IOMMU to pass-through mode, ensuring efficient and direct hardware access for VMs."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"By adding these parameters to your bootloader configuration, you set the stage for effective virtualization, enhancing your ability to run virtual machines and perform related tasks."}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"12-configuring-grub",children:"1.2 Configuring GRUB"}),"\n",(0,t.jsx)(n.p,{children:"If you\u2019re using the GRUB bootloader, follow these steps to configure it:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Open the GRUB configuration file at ",(0,t.jsx)(n.code,{children:"/etc/default/grub"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo vim /etc/default/grub\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Locate the line beginning with ",(0,t.jsx)(n.code,{children:"GRUB_CMDLINE_LINUX_DEFAULT"}),". Add your parameters to this line."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Save your changes and regenerate the GRUB configuration with:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo grub-mkconfig -o /boot/grub/grub.cfg\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Reboot your system to apply the new GRUB configuration."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Your GRUB bootloader should now include the necessary parameters for an optimized virtualization setup."}),"\n",(0,t.jsx)(n.h4,{id:"grub-configuration-examples",children:"GRUB Configuration Examples"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"For AMD CPUs:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'GRUB_CMDLINE_LINUX_DEFAULT="quiet amd_iommu=on iommu=pt video=efifb:off"\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"For Intel CPUs:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'GRUB_CMDLINE_LINUX_DEFAULT="quiet intel_iommu=on iommu=pt"\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"13-configuring-bootctl",children:"1.3 Configuring bootctl"}),"\n",(0,t.jsxs)(n.p,{children:["If you\u2019re using ",(0,t.jsx)(n.code,{children:"bootctl"})," as your bootloader, here\u2019s how to configure it:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Edit your configuration file located at ",(0,t.jsx)(n.code,{children:"/boot/loader/entries/your_config.conf"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"sudo vim /boot/loader/entries/your_config.conf\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Find the line starting with ",(0,t.jsx)(n.code,{children:"options"})," and modify it. For instance, if you have an AMD CPU, change it to:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"options root=<root> quiet rw amd_iommu=on iommu=pt video=efifb:off\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Save your changes."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Reboot your system to activate the new configuration."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Your bootloader configuration should now look something like this:"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"For AMD CPUs:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"title Arch Linux\nlinux /vmlinuz-linux\ninitrd /initramfs-linux.img\noptions root=<root> quiet rw amd_iommu=on iommu=pt video=efifb:off\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"For Intel CPUs:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"title Arch Linux\nlinux /vmlinuz-linux\ninitrd /initramfs-linux.img\noptions root=<root> quiet rw intel_iommu=on iommu=pt\n"})}),"\n",(0,t.jsx)(n.p,{children:"With these configurations in place, your bootloader is now primed to support virtualization."}),"\n",(0,t.jsx)(n.h2,{id:"whats-next",children:"What's Next"}),"\n",(0,t.jsxs)(n.p,{children:["For the next step, we\u2019re going to enable the GPU needed to empower virtualization. This includes modifying the ",(0,t.jsx)(n.code,{children:"mkinitcpio.conf"})," file, identifying the IOMMU GPU IDs, configuring the ",(0,t.jsx)(n.code,{children:"vfio.conf"})," file, and regenerating the ",(0,t.jsx)(n.code,{children:"mkinitcpio"})," image with the new configuration. Finally, you\u2019ll need to verify that the GPU is using the ",(0,t.jsx)(n.code,{children:"vfio-pci"})," driver by checking the ",(0,t.jsx)(n.code,{children:"Kernel driver in use"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>d});var o=i(6540);const t={},r=o.createContext(t);function s(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);